<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Group Finder</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link href="Assets/CustomGroups.css" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="//use.fontawesome.com/releases/v5.0.7/css/all.css"
    />

    <script
      type="text/javascript"
      src="https://mpweb.azureedge.net/cdn/customWidget.js"
    ></script>

    
    <link href="https://coltonwirgau.github.io/WoodsideBibleChurch/MP_Widgets/Custom_Widgets/Banner/Assets/BannerWidget.css" rel="stylesheet" />
  </head>

  <body>
    <div id="groupFinderContainer" class="container">
      <div id="groupTag"></div>
    </div>

    <script type="text/javascript">
      var tag = `
            <div class="container">
                    <div id="CustomGroupFinderWidget" 
                        data-component="CustomWidget"
                        data-sp="api_custom_GroupFinderWidget" 
                        data-params="{params}"
                        data-template="/WoodsideBibleChurch/MP_Widgets/Custom_Widgets/GroupFinder/Template/GroupFinder.html" 
                        data-requireUser="false" 
                        data-cache="false" 
                        data-host="woodsidebible"
                        data-debug="true">
                    </div>  
                </div>`;

      var groupTag = document.getElementById("groupTag");

      const allowedKeys = [
        "@CongregationID",
        "@DaysOfWeek",
        "@Cities",
        "@Leaders",
        "@GroupIDs",
        "@Search",
        "@Tags",
      ];

      // Change the group tag to what is in the url parameters
      groupTag.innerHTML = tag.replace("{params}", getUrlParams());

      function getUrlParams(url = window.location.href) {
        const params = new URLSearchParams(new URL(url).search);
        return Array.from(params.entries())
          .map(([key, value]) => `${key}=${value}`)
          .join("&");
      }
  </body>
</html>
